!function(){var n=document.querySelector(".controls"),t=document.querySelector(".game-score"),e=document.querySelectorAll(".field-row"),r=document.querySelector(".message-start"),o=document.querySelector(".message-win"),i=document.querySelector(".message-lose");n.insertAdjacentHTML("beforeend",'\n  <button\n    class="button restart hidden"\n    >Restart\n  </button>\n');var s=document.querySelector(".start"),u=document.querySelector(".restart"),a={isRunning:!1,isWon:!1,isLost:!1,score:0,rowsQty:e.length,colsQty:e[0].children.length,matrix:[]},c={moveRight:function(n){n.forEach(function(n){n.forEach(function(t,e){0===t&&(n.splice(e,1),n.unshift(0))});for(var t=n.length-1;t>=0;t--)if(n[t]>0&&n[t]===n[t-1]){var e=2*n[t];n.splice(t-1,2,e),n.unshift(0),a.score+=e}})},moveLeft:function(n){n.forEach(function(n){for(var t=n.length-1;t>=0;t--)0===n[t]&&(n.splice(t,1),n.push(0));for(var e=0;e<n.length;e++)if(n[e]>0&&n[e]===n[e+1]){var r=2*n[e];n.splice(e,2,r),n.push(0),a.score+=r}})},moveUp:function(n){var t=g(n);this.moveLeft(t);var e=g(t);a.matrix=e},moveDown:function(n){var t=g(n);this.moveRight(t);var e=g(t);a.matrix=e}},f={moveLeft:function(n){for(var t=0;t<n.length;t++)for(var e=n[t],r=0;r<e.length;r++){if(0!==e[r]&&e[r]===e[r+1])return!0;var o=!1;if(0===e[r]&&(o=e.slice(r).some(function(n){return n>0})),o)return!0}return!1},moveRight:function(n){for(var t=0;t<n.length;t++)for(var e=n[t],r=e.length;r>=0;r--){if(0!==e[r]&&e[r]===e[r-1])return!0;var o=!1;if(0===e[r]&&(o=e.slice(0,r).some(function(n){return n>0})),o)return!0}return!1},moveUp:function(n){var t=g(n);return this.moveLeft(t)},moveDown:function(n){var t=g(n);return this.moveRight(t)}};function l(){for(var n=[],t=0;t<a.rowsQty;t++){n.push([]);for(var e=0;e<a.colsQty;e++)n[t][e]=0}a.matrix=n}function v(){for(var n=function(n){a.matrix[n].forEach(function(t,r){var o=e[n].children[r];o.className="field-cell",o.textContent="",0!==t&&(o.classList.add("field-cell--"+t),o.textContent=t)})},r=0;r<a.matrix.length;r++)n(r);t.textContent=a.score}function m(){for(var n=Math.random()>.1?2:4;;){var t=Math.floor(4*Math.random()),e=Math.floor(4*Math.random());if(0===a.matrix[t][e]){a.matrix[t][e]=n;break}}}function h(n,t){n.classList.toggle("hidden",t)}function g(n){for(var t=[],e=0;e<n.length;e++){t.push([]);for(var r=0;r<n[e].length;r++)t[e].push(n[r][e])}return t}s.addEventListener("click",function(){a.isRunning=!0,a.isWon=!1,a.score=0,h(s,a.isRunning),h(u,!a.isRunning),h(r,a.isRunning),h(o,a.isRunning),l(),m(),m(),v()}),u.addEventListener("click",function(){a.isRunning=!0,a.isLost=!1,a.score=0,h(i,!a.isLost),l(),m(),m(),v()}),document.addEventListener("keydown",function(n){var t=n.key;if(t.startsWith("Arrow")&&a.isRunning){event.preventDefault();var e,r=t.replace("Arrow","move");f[r](a.matrix)&&(c[r](a.matrix),m(),v(),function(n){var t=!0,e=!1,r=void 0;try{for(var o,i=n[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)if(o.value.some(function(n){return 2048===n}))return!0}catch(n){e=!0,r=n}finally{try{t||null==i.return||i.return()}finally{if(e)throw r}}return!1}(a.matrix)&&(a.isWon=!0,a.isRunning=!1,h(o,!a.isWon),h(u,!a.isRunning),h(s,a.isRunning)),e=a.matrix,[f.moveLeft(e),f.moveRight(e),f.moveUp(e),f.moveDown(e)].some(function(n){return!0===n})||(a.isRunning=!1,a.isLost=!0,h(i,!a.isLost)))}})}();
//# sourceMappingURL=index.02575b9c.js.map
